<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="extend_product_categories" inherit_id="website_sale.products_categories">
        <xpath expr="//ul[@class='nav nav-pills flex-column mt16']" position="replace">
            <ul class="nav nav-pills flex-column bg-white coc-nav">
                <li class="nav-item">
                    <div class="p-2">
                        <strong>Categories</strong>
                    </div>
                </li>
                <t t-foreach="categories" t-as="c">
                    <t t-call="website_sale.categories_recursive" />
                </t>
                <li class="nav-item">
                    <div class="mt-2 p-2">
                        <strong>Brands</strong>
                    </div>
                    <t t-if="brands">
                        <form class="js_attributes" method="get">
                            <div id="brands_div" class="d-flex justify-content-center pb-4">
                                <div class="row col-12">
                                    <t t-foreach="brands" t-as="brand">
                                        <div class="col-3 mb4" style="padding: 2px; position: relative">
                                            <input class="brand-checkbox" type="checkbox" t-att-id="slug([brand.id, brand.name])" name="brands"
                                                       t-att-value="'%s-%s' % (brand.name,brand.id)"
                                                       t-att-checked="'checked' if brand.id in brand_set else None" style="display: none;"/>
                                            <label t-att-for="slug([brand.id, brand.name])" class="coc-brand-label" t-att-title="brand.name">
                                                <span t-field="brand.brand_image" t-options="{'widget': 'image', 'resize': '94x94'}"/>
                                            </label>
                                        </div>
                                    </t>
                                </div>
                            </div>
                        </form>
                    </t>
                </li>
            </ul>
        </xpath>

        <xpath expr="//div[@id='products_grid_before']" position="attributes">
            <attribute name="class">col-md-3 col-lg-3 d-none d-md-block</attribute>
        </xpath>
    </template>

    <template id="extend_products_attributes" inherit_id="website_sale.products_attributes">
        <xpath expr="//div[@id='products_grid_before']" position="attributes">
            <attribute name="class">col-md-3 col-lg-3 d-none d-md-block</attribute>
        </xpath>
    </template>

    <template id="extend_categories_recursive" inherit_id="website_sale.categories_recursive">
        <xpath expr="//li[@class='nav-item']" position="replace">
            <li class="nav-item">
                <a t-att-href="'/shop/category/' + slug(c)" t-attf-class="nav-link#{' coc-nav__active' if c.id == int(category or 0) else ''}" style="position: relative;">
                    <span t-field="c.name"/> <span t-if="c.child_id" class="fa fa-angle-right" style="position: absolute; right: 2%; top: 20%;" />
                </a>

                <div class="coc-nav__dropdown">
                    <ul t-if="c.child_id" class="nav nav-pills flex-column">
                        <t t-foreach="c.child_id" t-as="d">
                            <li class="nav-item">
                                <a t-att-href="'/shop/category/' + slug(d)" t-attf-class="nav-link#{' coc-nav__active' if d.id == int(category or 0) else ''}">
                                    <span t-field="d.name"/>
                                </a>
                            </li>
                        </t>
                    </ul>
                </div>
            </li>
        </xpath>
    </template>

    <template id="extend_product" inherit_id="website_sale.product">
        <xpath expr="//div[@class='form-inline justify-content-end']" position="replace">
            <t t-call="website_sale.pricelist_list">
                <t t-set="_classes">ml-2</t>
            </t>
        </xpath>
    </template>

    <template id="extend_search" inherit_id="website_sale.search" name="Search Box">
        <xpath expr="//form[@method='get']" position="replace">
            <form action="/shop" method="get" t-att-class="_classes">
                <t t-call="website.website_search_box" />
            </form>
        </xpath>
    </template>

    <template id="side_cart" name="Side Cart">
        <div class="p-2 text-white d-flex align-items-center side_cart__title">
            <div onclick="openCartNav()" class="p-2" style="cursor: pointer">
                <span class="fa fa-chevron-left" role="img" />
            </div>

            <div class="pl-2">
                <strong>MY CART</strong>
            </div>
        </div>

        <div t-if="not website_sale_order or not website_sale_order.website_order_line" class="my-2">
            <div class="p-3 side_cart__empty">
                Your cart is empty!
            </div>
        </div>

        <div class="my-1 side_cart__count" t-if="website_sale_order and website_sale_order.website_order_line">
            <div class="p-3 mb-2">
                You have <span class="sidecart-totalqty" t-esc="website_sale_order.cart_quantity" /> items(s) in your cart.
            </div>

            <t t-foreach="website_sale_order.website_order_line" t-as="line">
                <div class="d-flex justify-content-between align-items-center oe_website_sale m-0 side_cart__product">
                    <div class="col-2 p-0 pl-1">
                        <span t-field="line.product_id.image_medium" t-options="{'widget': 'image', 'class': 'rounded'}" />
                    </div>

                    <div class="col-3 col-md-4 col-lg-4 p-0" style="font-size: 85%">
                        <span t-field="line.name_short" />
                    </div>

                    <div t-if="not line.linked_line_id" class="css_quantity input-group col-2 col-md-2 col-lg-2 p-0">
                        <div class="input-group-prepend">
                            <button class="btn btn-link js_add_cart_json d-none d-md-inline-block p-1 text-secondary" aria-label="Remove one" title="Remove one">
                                <i class="fa fa-minus" />
                            </button>
                        </div>
                        <input type="text" class="form-control sidecart-qty quantity text-center p-0" t-att-data-line-id="line.id" t-att-data-product-id="line.product_id.id" t-att-value="int(line.product_uom_qty) == line.product_uom_qty and int(line.product_uom_qty) or line.product_uom_qty" maxlength="2" style="min-width: 30px" />
                        <div class="input-group-append">
                            <button class="btn btn-link float_left js_add_cart_json d-none d-md-inline-block p-1 text-secondary" aria-label="Add one" title="Add one">
                                <i class="fa fa-plus" />
                            </button>
                        </div>
                    </div>
                    <t t-if="line.linked_line_id">
                        <div>
                            <span class="js_quantity text-muted" t-att-data-line-id="line.id" t-att-data-product-id="line.product_id.id" t-esc="int(line.product_uom_qty)"/>
                        </div>
                    </t>

                    <div class="col-2 col-md-2 col-lg-2 text-center">
                        <span class="sidecart-subtotal" t-esc="line.price_subtotal" t-options="{'widget': 'monetary', 'display_currency': website.currency_id}"/>
                    </div>

                    <div class="col-1 col-md-1 col-lg-1">
                        <a href='#' aria-label="Remove from cart" title="Remove from cart" class='js_delete_product no-decoration text-secondary'> <i class='fa fa-times' /></a>
                    </div>
                </div>
            </t>

            <div t-if="website_sale_order and website_sale_order.cart_quantity" class="d-flex mt-3 justify-content-between px-2 sidecart-totaldiv">
                <div>
                    <strong>TOTAL</strong>
                </div>

                <div class="text-right">
                    <strong class="sidecart-total" t-field="website_sale_order.amount_total"
                      t-options='{"widget": "monetary", "display_currency": website_sale_order.pricelist_id.currency_id}'/>
                </div>
            </div>

            <div t-if="website_sale_order and website_sale_order.cart_quantity" class="mt-2 text-center px-2 sidecart-checkoutdiv">
                <a role="button" t-if="website_sale_order and website_sale_order.website_order_line" class="btn btn-info w-100" href="/shop/checkout?express=1">
                    <strong>Checkout</strong>
                </a>
            </div>
        </div>
    </template>

    <template id="extend_header" inherit_id="website_sale.header" name="Header Shop My Cart Link">
        <xpath expr="//header//ul[@id='top_menu']" position="before">
            <t t-call="extended_ecommerce.extend_search">
                <t t-set="_classes">o_website_sale_search</t>
            </t>
        </xpath>

        <xpath expr="//header//nav[@class='navbar navbar-expand-md navbar-light bg-light']" position="after">
            <div class="d-flex justify-content-around coc-nav-bottom text-center d-block d-md-none d-lg-none" role="group">
                <div>
                    <div class="nav-link pt-1 pb-0" style="cursor: pointer; position: relative" title="CartOnClick" onclick="location.href = '/';">
                        <img width="30" src="/extended_ecommerce/static/src/images/home_white.svg"/>
                    </div>

                    <span class="small">
                        Home
                    </span>
                </div>

                <div id="my_category">
                    <div class="nav-link catnav-toggle pt-1 pb-0" style="cursor: pointer; position: relative" title="Categories">
                        <img width="30" src="/extended_ecommerce/static/src/images/categories_white.svg"/>
                    </div>

                    <span class="small">
                        Categories
                    </span>
                </div>
                <div id="my_cart">
                    <div class="nav-link sidecart-toggle pt-1 pb-0" style="cursor: pointer; position: relative" title="Shopping Cart">
                        <sup t-attf-class="my_cart_quantity badge badge-pill badge-primary" t-esc="website_sale_order and website_sale_order.cart_quantity or ''" style="position: absolute; top: 5%; right: 1%" />
                        <img width="30" src="/extended_ecommerce/static/src/images/cart_white.svg"/>
                    </div>
                    <span class="small">
                        My Cart
                    </span>
                </div>
                <div id="my_account">
                    <div t-if="user_id._is_public()" class="nav-link pt-1 pb-0" style="cursor: pointer; position: relative" title="Account" onclick="location.href = '/web/login';">
                        <img width="30" src="/extended_ecommerce/static/src/images/account_white.svg"/>
                    </div>

                    <div t-if="not user_id._is_public()" class="nav-link account-toggle pt-1 pb-0" style="cursor: pointer; position: relative" title="Account">
                        <sup t-attf-class="my_wish_quantity o_animate_blink badge badge-danger" t-esc="wishcount or ''" style="position: absolute; top: 5%; right: 1%" />
                        <img width="30" src="/extended_ecommerce/static/src/images/account_white.svg"/>
                    </div>
                    <span class="small">
                        Account
                    </span>
                </div>
            </div>
        </xpath>

        <xpath expr="//header//nav[@class='navbar navbar-expand-md navbar-light bg-light']" position="attributes">
            <attribute name="class">navbar navbar-expand-md navbar-light bg-light d-none d-md-block d-lg-block nav-sticky-bg</attribute>
        </xpath>

        <xpath expr="//header" position="before">
            <div id="sidecart" class="coc-sidenav__cart pb-3">

            </div>

            <div id="account-div" class="coc-sidenav__cart">
                <div class="p-2 bg-primary text-white d-flex align-items-center" style="height: 52px;">
                    <div onclick="categoryNav()" class="p-2" style="cursor: pointer">
                        <span class="fa fa-chevron-left" role="img" />
                    </div>

                    <div class="pl-2" style="font-size: 120%">
                        <strong>MY ACCOUNT</strong>
                    </div>
                </div>

                <div class="list-group" style="border-top: 0; border-left: 0; border-right: 0;">
                    <a href="/my/home" role="menuitem" class="list-group-item list-group-item-action"><span class="fa fa-chevron-right" role="img" /> Orders</a>
                    <t t-set='wishcount' t-value="len(request.env['product.wishlist'].current())"/>
                    <a href="/shop/wishlist" class="list-group-item list-group-item-action"><span class="fa fa-chevron-right" role="img" /> Wishlist <sup t-attf-class="my_wish_quantity o_animate_blink badge badge-danger"><t t-esc='wishcount'/></sup>
                    </a>
                    <a id="o_logout" class="list-group-item list-group-item-action" t-attf-href="/web/session/logout?redirect=/" role="menuitem"><span class="fa fa-chevron-right" role="img" /> Logout</a>
                </div>
            </div>

            <div id="mobile-category" class="coc-sidenav">
                <div class="p-2 text-white d-flex align-items-center side_cart__title">
                    <div onclick="categoryNav()" class="p-2" style="cursor: pointer">
                        <span class="fa fa-chevron-left" role="img" />
                    </div>

                    <div class="pl-2">
                        <strong>CATEGORIES</strong>
                    </div>
                </div>

                <t t-if="categories">
                    <div class="row m-0">
                        <div class="col-3 p-0" style="height: 88vh; background: #e6e6e6; overflow-x: hidden; overflow-y: auto; scroll-behavior: smooth; -webkit-overflow-scrolling: touch;">
                            <ul class="nav nav-pills flex-column text-center" id="myTab" role="tablist">
                                <t t-foreach="categories" t-as="cat">
                                    <li class="nav-item p-0">
                                        <a class="nav-link px-2 py-3" t-att-id="cat.id" data-toggle="tab" t-att-href="'#%s' % slug([cat.id, cat.name])" role="tab" t-att-aria-controls="cat.name" aria-selected="true">
                                            <div class="mb-1">
                                                <span t-field="cat.icon" t-options="{'widget': 'image'}"/>
                                            </div>
                                            <span class="small text-secondary" t-esc="cat.name" />
                                        </a>
                                    </li>
                                </t>
                            </ul>
                        </div>

                        <div class="col-9 mt-1" style="height: 84vh; overflow-x: hidden; overflow-y: auto; scroll-behavior: smooth; -webkit-overflow-scrolling: touch;">
                            <div class="tab-content">
                                <t t-foreach="categories" t-as="cat">
                                    <div class="tab-pane fade" t-att-id="slug([cat.id, cat.name])" role="tabpanel" aria-labelledby="home-tab">
                                        <span class="text-secondary">Brands</span>
                                        <div class="row my-2 coc-mobile-wrapper">
                                            <t t-foreach="cat._get_brands()" t-as="brand">
                                                <div class="col-4 d-flex align-items-center">
                                                    <a t-att-href="'/shop/category/%s?brands=%s-%s' % (slug([cat.id,cat.name]),brand.name,brand.id)">
                                                        <span t-field="brand.brand_image" t-options="{'widget': 'image', 'resize': '96x96'}"/>
                                                    </a>
                                                </div>
                                            </t>
                                        </div>
                                        <div class="row text-center" style="border-top: 1px dotted #ccc">
                                            <t t-foreach="cat.child_id" t-as="sub">
                                                <div class="col-6 mt-2">
                                                    <a t-att-href="'/shop/category/%s' % slug([sub.id, sub.name])">
                                                        <t t-if="len(sub.product_ids) &gt; 0">
                                                            <span t-field="sub._get_random_product()[0].image" t-options="{'widget': 'image', 'resize': '80x80'}"/>
                                                        </t>

                                                        <t t-else="">
                                                            <span t-field="sub.image" t-options="{'widget': 'image', 'resize': '80x80'}"/>
                                                        </t>

                                                        <div>
                                                            <span  t-esc="sub.name"/>
                                                        </div>
                                                    </a>
                                                </div>
                                            </t>
                                        </div>
                                    </div>
                                </t>
                            </div>
                        </div>
                    </div>
                </t>
            </div>

            <section id="sticky-anchor" class="d-block d-md-none d-lg-none">
                <t t-set="banners" t-value="request.env['website.banner'].generate('mobile')"/>

                <div id="myCarousel1567135242293" class="s_carousel carousel slide s_carousel_default" data-interval="3000">
                    <ol class="carousel-indicators">
                        <t t-foreach="banners" t-as="banner">
                            <li data-target="#myCarousel1567135242293" t-att-data-slide-to="'%s' % (banners.index(banner))" t-att-class="'active' if banners[0].id == banner.id else ''"/>
                        </t>
                    </ol>

                    <div class="carousel-inner text-center">
                        <t t-foreach="banners" t-as="banner">
                            <div t-att-class="'carousel-item oe_custom_bg oe_img_bg active' if banners[0].id == banner.id else 'carousel-item oe_custom_bg oe_img_bg'" data-name="Slide">
                                <a t-att-href="banner.link if banner.link else '#'">
                                    <img class="img img-fluid" t-att-src="'/web/image/website.banner/%s/url' % (banner.id)"/>
                                </a>
                            </div>
                        </t>
                    </div>
                </div>
            </section>

            <t t-call="extended_ecommerce.extend_search">
                <t t-set="_classes">o_website_sale_search d-block d-md-none d-lg-none coc-sticky</t>
            </t>

            <script>
                function sticky_relocate() {
                  var window_top = $(window).scrollTop();
                  var div_top = $('#sticky-anchor').offset().top;
                  if (window_top > div_top) {
                    $('.coc-sticky').addClass('coc-stick');
                    $('.coc-sticky > div').addClass('coc-search-sticky');
                  } else {
                    $('.coc-sticky').removeClass('coc-stick');
                    $('.coc-sticky > div').removeClass('coc-search-sticky');
                  }
                }

                $(function() {
                  $(window).scroll(sticky_relocate);
                  sticky_relocate();
                })
            </script>
        </xpath>

        <xpath expr="//li[@id='my_cart']" position="replace">
            <li id="my_cart" t-attf-class="nav-item">
                <div class="nav-link sidecart-toggle" style="cursor: pointer; position: relative" title="My Cart">
                    <sup t-attf-class="my_cart_quantity badge badge-pill badge-primary" t-esc="website_sale_order and website_sale_order.cart_quantity or ''" style="position: absolute; top: 5%; right: 1%" />
                    <img width="32" class="cart-icon" src="/extended_ecommerce/static/src/images/cart_dark.svg"/>
                </div>
            </li>
        </xpath>

        <xpath expr="//li[@class='nav-item divider']" position="replace">
            <li class="nav-item divider d-none"/>
        </xpath>

        <xpath expr="//header//div[@class='container']" position="after">
                <script>
                    function categoryNav() {
                        const cat = $('#mobile-category');

                        if (cat.hasClass('coc-sidenav__show')) {
                            cat.removeClass('coc-sidenav__show')
                            cat.addClass('coc-sidenav__hide')
                        } else {
                            cat.addClass('coc-sidenav__show')
                            cat.removeClass('coc-sidenav__hide')
                        }
                    }

                    function openCartNav(persist = false) {
                        const cart = $('#sidecart');

                        if (cart.hasClass('coc-sidenav__show') &amp;&amp; !persist) {
                            cart.removeClass('coc-sidenav__show')
                            cart.addClass('coc-sidenav__hide')
                        } else {
                            cart.addClass('coc-sidenav__show')
                            cart.removeClass('coc-sidenav__hide')
                        }
                    }
                </script>
        </xpath>
    </template>

    <template id="extend_products_list" inherit_id="website_sale.products">
        <xpath expr="//div[@class='products_pager form-inline justify-content-center']" position="replace">
            <div class="products_pager justify-content-center" style="display: none">
                <t t-call="website_sale.search">
                    <t t-set="_classes">o_website_sale_search</t>
                </t>
                <t t-call="website_sale.pricelist_list">
                    <t t-set="_classes">ml-2</t>
                </t>
                <t t-call="website.pager">
                    <t t-set="_classes">ml-2</t>
                </t>
            </div>
        </xpath>
        <xpath expr="//div[@id='products_grid']" position="replace">
            <div class="col-12 col-md-9 col-lg-9 coc-featured-products px-0">
                <t t-if="search">
                    <div class="bg-white py-2 pl-3">
                        <h5 class="m-0">
                            <span t-esc="search_count"/> items found for "<strong t-esc='search'/>"
                        </h5>
                    </div>
                </t>
                <div t-if="category" class="text-center bg-white py-2 mb-2">
                    <div class="my-3">
                        <h4 style="font-weight: 600; color: #1f3365;">
                            <span t-esc="category.name if category.child_id else category.parent_id.name"/>
                        </h4>
                    </div>

                    <t t-foreach="category.child_id" t-as="cat">
                        <a t-att-href="keep('/shop/category/' + slug(cat), category=0)" class="btn coc-btn__preview--stock mb4 text-dark"><span t-esc="cat.name" /></a>
                    </t>

                    <t t-foreach="category.parent_id.child_id" t-as="cat2">
                        <a t-att-href="keep('/shop/category/' + slug(cat2), category=0)" t-attf-class="btn coc-btn__preview--stock mb4 text-dark#{' coc-btn__preview--active' if cat2.id == int(category or 0) else ''}"><span t-esc="cat2.name" /></a>
                    </t>
                </div>

                <div t-foreach="bins" t-as="tr_product" class="row mx-0 px-1 px-md-0 px-lg-0">
                    <div t-foreach="tr_product" t-as="td_product" t-if="td_product['product'].website_published" class="col-6 col-md-3 px-1 d-flex justify-content-between flex-column">
                        <t t-set="product" t-value="td_product['product']" />
                        <t t-set="product_href" t-value="'/shop/product/%s' % slug([product.id, product.name])" />

                        <div class="card mb-2">
                            <div class="coc-add-wishlist">
                                <t t-set="in_wish" t-value="product._is_in_wishlist()"/>
                                <t t-set="product_variant_id" t-value="product._get_first_possible_variant_id()"/>
                                <t t-set="secondary_categ" t-value="0 if not product.public_categ_ids[1] else 1"/>
                                <button t-if="product_variant_id" type="button" role="button" class="btn btn-danger o_add_wishlist update_sticky_wishlist" style="border-radius: 2px 0 0 0;" t-att-disabled='in_wish or None' title="Add to Wishlist" t-att-data-product-template-id="product.id" t-att-data-product-product-id="product_variant_id" data-action="o_wishlist"><span class="fa fa-heart" role="img" aria-label="Add to wishlist" /></button>
                                <a t-att-href="'/shop/category/%s?brands=%s-%s' % (slug([product.public_categ_ids[secondary_categ].id, product.public_categ_ids[secondary_categ].name]), product.brand_id.name, product.brand_id.id)" class="btn btn-secondary w-100">
                                    FIND SIMILAR
                                </a>
                            </div>

                            <a t-att-href="product_href">
                                <span class="card-img-top" t-field="product.image" t-options="{'widget': 'image', 'resize': '300x300'}"/>
                            </a>
                            <div class="card-body p-2 d-flex justify-content-between flex-column">
                                <div>
                                    <t t-set="namelen" t-value="0 if len(product.name) &lt; 40 else 0 - (len(product.name) - 35)"/>
                                    <a t-att-href="product_href">
                                        <span class="card-title" t-esc="product.name if namelen == 0 else product.name[:namelen] + '&#x2026;'" t-att-title="product.name" />
                                    </a>
                                </div>

                                <div>
                                    <div class="my-2">
                                        <span class="price" t-esc="product._get_combination_info()['price']" t-options="{'widget': 'monetary', 'display_currency': website.currency_id}"/>
                                        <span t-attf-class="text-muted old-price {{'' if product._get_combination_info()['has_discounted_price'] else 'd-none'}}" t-esc="product._get_combination_info()['list_price']" t-options="{'widget': 'monetary', 'display_currency': website.currency_id}"
          />
                                        <t t-if="product._get_combination_info()['has_discounted_price']">
                                            <t t-set="show_percent" t-value="100 - round((product._get_combination_info()['price'] / product._get_combination_info()['list_price']) * 100)"/>
                                            -<span t-esc="show_percent" class="old-price__percent" t-options="{'widget': 'integer'}"/>%
                                        </t>
                                    </div>

                                    <div class="text-center" t-if="product._is_add_to_cart_possible()">
                                        <t t-if="(product.inventory_availability == 'never') or (product.inventory_availability == 'always' and product.qty_available &gt; 0)">
                                            <button type="button" role="button" t-att-data-product-id="product.product_variant_id.id" class="btn coc-btn__preview--stock ajax_add_cart o_animate_blink" ><span class="fa fa-shopping-cart" /> ADD TO CART</button>
                                        </t>
                                        <t t-else="">
                                            <button class="btn coc-btn__preview--outstock disabled"><span class="fa fa-cube" /> OUT OF STOCK</button>
                                        </t>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <t t-if="not bins and not search">
                    <div class="text-center text-muted oe_product">
                        <h3 class="css_editable_display mt8">No product available for this category.</h3>
                    </div>
                </t>
            </div>
        </xpath>
    </template>

    <template id="extend_cart_lines" inherit_id="website_sale.cart_lines">
        <xpath expr="//td[@class='text-center td-qty']" position="replace">
            <td class="text-center td-qty">
                <div t-if="not line.linked_line_id" class="css_quantity input-group mx-auto oe_website_spinner">
                    <div t-if="line.product_id.name != 'Gift Coupon'" class="input-group-prepend">
                        <a t-attf-href="#" class="btn btn-link js_add_cart_json d-none d-md-inline-block" aria-label="Remove one" title="Remove one">
                            <i class="fa fa-minus"></i>
                        </a>
                    </div>
                    <input type="text" class="js_quantity form-control quantity" t-att-style="'display: block;' if line.product_id.name != 'Gift Coupon' else 'display:none;'" t-att-data-line-id="line.id" t-att-data-product-id="line.product_id.id" t-att-value="int(line.product_uom_qty) == line.product_uom_qty and int(line.product_uom_qty) or line.product_uom_qty" />
                    <div t-if="line.product_id.name != 'Gift Coupon'" class="input-group-append">
                        <a t-attf-href="#" class="btn btn-link float_left js_add_cart_json d-none d-md-inline-block" aria-label="Add one" title="Add one">
                            <i class="fa fa-plus"></i>
                        </a>
                    </div>
                </div>
                <t t-if="line.linked_line_id and line.product_id.name != 'Gift Coupon'">
                    <span class="js_quantity text-muted" t-att-data-line-id="line.id" t-att-data-product-id="line.product_id.id" t-esc="int(line.product_uom_qty)"/>
                </t>
            </td>
        </xpath>
    </template>

    <template id="new_website_address" inherit_id="website_sale.address" name="Address Management">
        <xpath expr="//div[@class='form-row']" position="replace">
            <div class="form-row">
                <div t-attf-class="form-group #{error.get('name') and 'o_has_error' or ''} col-lg-6 div_name">
                    <label class="col-form-label" for="name">Name</label>
                    <input type="text" name="name" t-attf-class="form-control #{error.get('name') and 'is-invalid' or ''}" t-att-value="'name' in checkout and checkout['name']" />
                </div>
                <t t-if="mode[1] == 'billing'">
                    <div t-attf-class="form-group #{error.get('email') and 'o_has_error' or ''} col-lg-6" id="div_email">
                        <label class="col-form-label" for="email">Email</label>
                        <input type="email" name="email" t-attf-class="form-control #{error.get('email') and 'is-invalid' or ''}" t-att-value="'email' in checkout and checkout['email']" />
                    </div>
                </t>
                <div t-attf-class="form-group #{error.get('phone') and 'o_has_error' or ''} col-lg-6" id="div_phone">
                    <label class="col-form-label" for="phone">Contact Number</label>
                    <input type="tel" name="phone" t-attf-class="form-control #{error.get('phone') and 'is-invalid' or ''}" t-att-value="'phone' in checkout and checkout['phone']" />
                </div>
                <div class="w-100"/>
                <div t-attf-class="form-group #{error.get('street') and 'o_has_error' or ''} col-lg-12 div_street">
                    <label class="col-form-label" for="street">Street Address</label>
                    <input type="text" name="street" t-attf-class="form-control #{error.get('street') and 'is-invalid' or ''}" t-att-value="'street' in checkout and checkout['street']" />
                </div>
                <div class="w-100"/>
                <div t-attf-class="form-group #{error.get('city') and 'o_has_error' or ''} col-md-6 div_city">
                    <label class="col-form-label" for="city">City</label>
                    <select name="city" t-attf-class="form-control #{error.get('city') and 'is-invalid' or ''}">
                        <option t-att-value="'Bacolod City'" t-att-selected="True">Bacolod City</option>
                    </select>
                </div>
                <div class="w-100"/>
                <t t-if="mode == ('new', 'billing') and not only_services">
                    <div class="col-lg-12">
                        <div class="checkbox">
                            <label>
                            <input type="checkbox" id='shipping_use_same' class="mr8" name='use_same' value="1" checked='checked'/>Ship to the same address
                            <span class='ship_to_other text-muted' style="display: none">&amp;nbsp;(<i>Your shipping address will be requested later) </i></span>
                            </label>
                        </div>
                    </div>
                </t>
            </div>
        </xpath>

        <xpath expr="//input[@name='csrf_token']" position="before">
            <input type="hidden" name="country_id" t-att-value="'176'" />
        </xpath>
    </template>

    <template id="website_sale.address_b2b" inherit_id="website_sale.address" name="Show b2b fields" customize_show="True" active="True">
        <xpath expr="//div[@id='div_phone']" position="after">
            <div class="w-100"/>
            <t t-if="mode == ('hidden')">
                <div t-attf-class="form-group #{error.get('company_name') and 'o_has_error' or ''} col-lg-6">
                    <label class="col-form-label font-weight-normal label-optional" for="company_name">Company Name</label>
                    <input type="text" name="company_name" t-attf-class="form-control #{error.get('company_name') and 'is-invalid' or ''}" t-att-value="'company_name' in checkout and checkout['company_name']" t-att-readonly="'1' if 'vat' in checkout and checkout['vat'] and not can_edit_vat else None" t-att-title="'Changing company name is not allowed once document(s) have been issued for your account. Please contact us directly for this operation.' if 'vat' in checkout and checkout['vat'] and not can_edit_vat else None" />
                </div>
                <div t-attf-class="form-group #{error.get('vat') and 'o_has_error' or ''} col-lg-6 div_vat">
                    <label class="col-form-label font-weight-normal label-optional" for="vat">TIN / VAT </label>
                    <input type="text" name="vat" t-attf-class="form-control #{error.get('vat') and 'is-invalid' or ''}" t-att-value="'vat' in checkout and checkout['vat']" t-att-readonly="'1' if 'vat' in checkout and checkout['vat'] and not can_edit_vat else None" t-att-title="'Changing VAT number is not allowed once document(s) have been issued for your account. Please contact us directly for this operation.' if 'vat' in checkout and checkout['vat'] and not can_edit_vat else None" />
                </div>
            </t>
        </xpath>
    </template>

    <template id="extend_product_quantity" inherit_id="website_sale.product_quantity">
        <xpath expr="//div[@class='css_quantity input-group oe_website_spinner']" position="replace">
            <div class="d-flex align-items-center mb-3">
                <div class="text-secondary pr-3" style="font-weight: 600">
                    Quantity
                </div>
                <div class="css_quantity input-group oe_website_spinner new_quantity_input" contenteditable="false">
                    <div class="input-group-prepend">
                        <span class="btn text-secondary xjs_add_cart_json" aria-label="Remove one" title="Remove one">
                            <i class="fa fa-minus" />
                        </span>
                    </div>
                    <input type="text" class="form-control quantity" data-min="1" name="add_qty" t-att-value="add_qty or 1"/>
                    <div class="input-group-append">
                        <span class="btn text-secondary float_left xjs_add_cart_json" aria-label="Add one" title="Add one">
                            <i class="fa fa-plus" />
                        </span>
                    </div>
                </div>
            </div>
        </xpath>
    </template>

    <template id="extend_wishlist_button" inherit_id="website_sale_wishlist.product_add_to_wishlist">
        <xpath expr="//button[@class='btn btn-secondary btn-lg mt8 o_add_wishlist_dyn']" position="replace">
        </xpath>
    </template>

    <template id="more_from_category" inherit_id="website_sale.recommended_products" customize_show="True" active="True">
        <xpath expr="//div[@class='col-md-4']" position="replace">
            <div class="col-md-8 px-0" style="font-size: 95%">
                <ol class="breadcrumb px-2 px-md-0 px-lg-0 m-0" style="background: transparent;">
                    <li class="breadcrumb-item">
                        <a href="/">Home</a>
                    </li>
                    <t t-foreach="product.public_categ_ids" t-as="cat">
                        <li class="breadcrumb-item">
                            <a t-att-href="keep('/shop/category/%s' % slug([cat.id, cat.name]), category=0)" t-field="cat.name" />
                        </li>
                    </t>
                    <li class="breadcrumb-item active">
                        <t t-set="namelen" t-value="0 if len(product.name) &lt; 50 else 0 - (len(product.name) - 50)"/>
                        <span t-esc="product.name if namelen == 0 else product.name[:namelen] + '&#x2026;'" />
                    </li>
                </ol>
            </div>
        </xpath>
        <xpath expr="//div[@id='product_details']" position="replace">
            <div class="col-md-6" id="product_details">
                <h4 itemprop="name" t-field="product.name" style="font-weight: 550">Product Name</h4>
                <div class="mt-2 mt-md-0">
<!--                    <t t-set="val_decimal" t-value="product._ratings_val_decimal()"/>-->
<!--                    <t t-set="empty_star" t-value="product._ratings_empty_star()"/>-->
<!--                    <div class="o_website_rating_static">-->
<!--                        <t t-foreach="product._ratings_val_integer_range()" t-as="num">-->
<!--                            <i class="fa fa-star" role="img" aria-label="One star" title="One star"></i>-->
<!--                        </t>-->
<!--                        <t t-if="val_decimal">-->
<!--                            <i class="fa fa-star-half-o" role="img" aria-label="Half a star" title="Half a star"></i>-->
<!--                        </t>-->
<!--                        <t t-foreach="product._ratings_empty_star_range()" t-as="num" role="img" t-attf-aria-label="#{empty_star} on 5" t-attf-title="#{empty_star} on 5">-->
<!--                            <i class="fa fa-star-o"></i>-->
<!--                        </t>-->
<!--                        <a href="#discussion" class="text-muted ml-1"><t t-esc="product.rating_count"/> Ratings</a>-->
<!--                    </div>-->

                    <div class="mt-1">
                        <span class="text-muted">Brand:</span>
                        <a t-att-href="'/shop?brands=%s-%s' % (product.brand_id.name,product.brand_id.id)">
                            <span t-esc="product.brand_id.name"/>
                        </a>
                    </div>
                </div>
                <span itemprop="url" style="display:none;" t-esc="'%sshop/product/%s' % (request.httprequest.url_root, slug(product))"/>
                <form t-if="product._is_add_to_cart_possible()" action="/shop/cart/update" method="POST">
                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />
                    <div class="js_product js_main_product">
                        <t t-placeholder="select">
                            <input type="hidden" class="product_id" name="product_id" t-att-value="product_variant.id" />
                            <input type="hidden" class="product_template_id" name="product_template_id" t-att-value="product.id" />
                            <t t-if="first_possible_combination" t-call="sale.variants">
                                <t t-set="ul_class" t-value="'flex-column'" />
                                <t t-set="parent_combination" t-value="None" />
                            </t>
                            <t t-else="">
                                <ul class="d-none js_add_cart_variants" t-att-data-attribute_exclusions="{'exclusions: []'}"/>
                            </t>
                        </t>

                        <hr/>
                        <div class="mt-1">
                            <span style="font-size: 180%; color: #ea810c;" t-esc="product._get_combination_info()['price']" t-options="{'widget': 'monetary', 'display_currency': website.currency_id}"/>
                            <span t-attf-class="text-muted oe_default_price {{'' if product._get_combination_info()['has_discounted_price'] else 'd-none'}}" style="text-decoration: line-through; white-space: nowrap;"
          t-esc="product._get_combination_info()['list_price']" t-options="{'widget': 'monetary', 'display_currency': website.currency_id}"
      />
                            <t t-if="product._get_combination_info()['has_discounted_price']">
                                <t t-set="show_percent" t-value="100 - round((product._get_combination_info()['price'] / product._get_combination_info()['list_price']) * 100)"/>
                                -<span t-esc="show_percent" class="old-price__percent" t-options="{'widget': 'integer'}" style="font-size: 85%"/>%
                            </t>
                        </div>
                        <hr/>

                        <p t-if="True" class="css_not_available_msg alert alert-warning">This combination does not exist.</p>

                        <a role="button" id="add_to_cart" class="btn btn-lg coc-btn__product js_check_product ajax_add_cart col-10 col-md-6 col-lg-6 d-none" href="#" />

                        <button type="button" role="button" t-att-data-product-id="product.product_variant_id.id" class="btn btn-lg coc-btn__product ajax_add_cart col-10 col-md-6 col-lg-6" >ADD TO CART</button>

                        <a t-if="product_variant" role="button" class="btn btn-lg coc-btn__product o_add_wishlist_dyn" t-att-disabled='in_wish or None' title="Add to Wishlist" t-att-data-product-template-id="product.id" t-att-data-product-product-id="product_variant.id" data-action="o_wishlist" style="color: red; background: #e0adad; border: 1px solid #ec8686;"><span class="fa fa-heart" role="img" aria-label="Add to wishlist" /></a>
                    </div>
                </form>
                <p t-elif="not product.active" class="alert alert-warning">This product is no longer available.</p>
                <p t-else="" class="alert alert-warning">This product has no valid combination.</p>
                <hr t-if="product.description_sale or product.description_ecommerce" />
                <div class="o_not_editable">
                    <p t-field="product.description_ecommerce" class="text-muted" />
                    <p t-field="product.description_sale" class="text-muted" />
                </div>
            </div>
        </xpath>

        <xpath expr="//div[@id='product_full_description']" position="after">
            <div t-foreach="more_from_category" t-as="categ" class="container px-0 oe_website_sale coc-featured-products">
                <div class="d-flex bg-white justify-content-between align-items-center py-3 mb-2">
                    <div class="text-secondary pl-3">
                        <strong>MORE FROM <span t-esc="categ['info'].name" style="text-transform: uppercase;"/></strong>
                    </div>

                    <div class="float-right mr-3">
                        <a class="float-right pl-2" t-att-href="keep('/shop/category/' + slug([categ['info'].id,categ['info'].name]), category=0)">
                            See all <span class="fa fa-angle-right"/>
                        </a>
                        <button class="btn btn-sm btn-outline-secondary scroll-to-left d-none d-md-inline"><span class="fa fa-chevron-left" role="img" aria-label="Prev" /></button>
                        <button class="btn btn-sm btn-outline-secondary scroll-to-right d-none d-md-inline"><span class="fa fa-chevron-right" role="img" aria-label="Next" /></button>
                    </div>
                </div>

                <div class="row mx-0 px-1 px-md-0 px-lg-0 scrollable">
                    <div t-foreach="categ['products']" t-as="product" class="col-6 col-md-3 col-lg-2 px-1 d-flex justify-content-between flex-column">
                        <t t-set="product_href" t-value="'/shop/product/%s' % slug([product.id, product.name])" />

                        <div class="card">
                            <div class="coc-add-wishlist">
                                <t t-set="in_wish" t-value="product._is_in_wishlist()"/>
                                <t t-set="product_variant_id" t-value="product._get_first_possible_variant_id()"/>
                                <t t-set="secondary_categ" t-value="0 if not product.public_categ_ids[1] else 1"/>
                                <button t-if="product_variant_id" type="button" role="button" class="btn btn-danger o_add_wishlist update_sticky_wishlist" style="border-radius: 2px 0 0 0;" t-att-disabled='in_wish or None' title="Add to Wishlist" t-att-data-product-template-id="product.id" t-att-data-product-product-id="product_variant_id" data-action="o_wishlist"><span class="fa fa-heart" role="img" aria-label="Add to wishlist" /></button>
                                <a t-att-href="'/shop/category/%s?brands=%s-%s' % (slug([product.public_categ_ids[secondary_categ].id, product.public_categ_ids[secondary_categ].name]), product.brand_id.name, product.brand_id.id)" class="btn btn-secondary w-100">
                                    FIND SIMILAR
                                </a>
                            </div>

                            <a t-att-href="product_href">
                                <span class="card-img-top" t-field="product.image" t-options="{'widget': 'image', 'resize': '300x300'}"/>
                            </a>
                            <div class="card-body p-2 d-flex justify-content-between flex-column">
                                <div>
                                    <t t-set="namelen" t-value="0 if len(product.name) &lt; 40 else 0 - (len(product.name) - 35)"/>
                                    <a t-att-href="product_href">
                                        <span class="card-title" t-esc="product.name if namelen == 0 else product.name[:namelen] + '&#x2026;'" t-att-title="product.name" />
                                    </a>
                                </div>

                                <div>
                                    <div class="my-2">
                                        <span class="price" t-esc="product._get_combination_info()['price']" t-options="{'widget': 'monetary', 'display_currency': website.currency_id}"/>
                                        <span t-attf-class="text-muted old-price {{'' if product._get_combination_info()['has_discounted_price'] else 'd-none'}}" t-esc="product._get_combination_info()['list_price']" t-options="{'widget': 'monetary', 'display_currency': website.currency_id}"
          />
                                        <t t-if="product._get_combination_info()['has_discounted_price']">
                                            <t t-set="show_percent" t-value="100 - round((product._get_combination_info()['price'] / product._get_combination_info()['list_price']) * 100)"/>
                                            -<span t-esc="show_percent" class="old-price__percent" t-options="{'widget': 'integer'}"/>%
                                        </t>
                                    </div>

                                    <div class="text-center" t-if="product._is_add_to_cart_possible()">
                                        <t t-if="(product.inventory_availability == 'never') or (product.inventory_availability == 'always' and product.qty_available &gt; 0)">
                                            <button type="button" role="button" t-att-data-product-id="product.product_variant_id.id" class="btn coc-btn__preview--stock ajax_add_cart o_animate_blink" ><span class="fa fa-shopping-cart" /> ADD TO CART</button>
                                        </t>
                                        <t t-else="">
                                            <button class="btn coc-btn__preview--outstock disabled"><span class="fa fa-cube" /> OUT OF STOCK</button>
                                        </t>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </xpath>
    </template>
</odoo>